<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Min profil – PeerRate</title>
  <link rel="stylesheet" href="/css/profile.css" />
</head>
<body>
  <div class="wrap">

    <!-- Inloggningsbadge -->
    <div id="user-badge" class="user-badge hidden">
      <div class="user-avatar" id="user-badge-avatar">PR</div>
      <div>
        <div class="user-label">Inloggad som</div>
        <div class="user-name" id="user-badge-name">–</div>
      </div>
    </div>

    <h1>Min profil</h1>
    <p class="lead">
      Här kan du se dina uppgifter och ditt samlade omdöme.
    </p>

    <!-- LOGIN-KORT (visas bara om man inte är inloggad) -->
    <section class="card" id="login-card">
      <h2>Logga in</h2>
      <p class="muted">
        Logga in med den e-post och det lösenord du registrerade dig med.
      </p>

      <form id="login-form" autocomplete="off">
        <label for="login-email">E-post</label>
        <input id="login-email" name="email" type="email" placeholder="erik@example.com" />

        <label for="login-password">Lösenord</label>
        <input id="login-password" name="password" type="password" placeholder="Ditt lösenord" />

        <div class="row" style="margin-top:12px">
          <button class="primary" type="submit" id="login-btn">Logga in</button>
        </div>

        <p id="login-status" class="tiny muted" style="margin-top:8px;"></p>
      </form>
    </section>

    <!-- Allt här visas bara när man är inloggad -->
    <div id="profile-root" class="hidden">

      <!-- Mina uppgifter -->
      <section class="card">
        <h2>Mina uppgifter</h2>
        <p class="tiny muted">Uppgifter kopplade till din profil.</p>

        <!-- Profilbild -->
        <div class="profile-avatar-block">
          <div class="profile-avatar-preview" id="profile-avatar-preview">PR</div>
          <div>
            <label class="profile-avatar-upload-label">
              Ladda upp profilbild
              <input type="file" id="profile-avatar-input" accept="image/*" />
            </label>
            <p class="profile-avatar-text">
              Bilden sparas bara lokalt i din webbläsare och kopplas till “Inloggad som”.
            </p>
          </div>
        </div>

        <ul class="profile-list">
          <li>
            <span class="profile-label">Namn</span>
            <span class="profile-value" id="profile-name">–</span>
          </li>
          <li>
            <span class="profile-label">E-post</span>
            <span class="profile-value" id="profile-email">–</span>
          </li>
          <li>
            <span class="profile-label">Personnummer</span>
            <span class="profile-value" id="profile-personalNumber">–</span>
          </li>
          <li>
            <span class="profile-label">Telefon</span>
            <span class="profile-value" id="profile-phone">–</span>
          </li>
          <li>
            <span class="profile-label">Gatuadress</span>
            <span class="profile-value" id="profile-addressStreet">–</span>
          </li>
          <li>
            <span class="profile-label">Postnummer</span>
            <span class="profile-value" id="profile-addressZip">–</span>
          </li>
          <li>
            <span class="profile-label">Ort</span>
            <span class="profile-value" id="profile-addressCity">–</span>
          </li>
          <li>
            <span class="profile-label">Land</span>
            <span class="profile-value" id="profile-country">–</span>
          </li>
        </ul>
      </section>

      <!-- Externa data -->
      <section class="card" id="external-data-section">
        <h2>Externa data</h2>
        <p class="tiny muted">
          Här visas viss information som hämtats från externa, offentliga källor kopplat till din profil.
          Uppgifterna uppdateras automatiskt med jämna mellanrum.
        </p>

        <ul class="profile-list">
          <li>
            <span class="profile-label">Fordon (antal)</span>
            <span class="profile-value" id="ext-vehicles-count"></span>
          </li>
          <li>
            <span class="profile-label">Fastigheter (antal)</span>
            <span class="profile-value" id="ext-properties-count"></span>
          </li>
          <li>
            <span class="profile-label">Senast uppdaterad</span>
            <span class="profile-value" id="ext-last-updated"></span>
          </li>
          <li>
            <span class="profile-label">Validerad adress</span>
            <span class="profile-value"><span data-field="externalAddressLine">–</span></span>
          </li>
          <li>
            <span class="profile-label">Adressstatus</span>
            <span class="profile-value"><span data-field="externalAddressStatus">–</span></span>
          </li>
        </ul>
      </section>

      <!-- Tradera-koppling -->
      <section class="card" id="tradera-card">
        <h2>Tradera-koppling</h2>
        <p class="tiny muted">
          Koppla ditt Tradera-konto för att visa avslutade affärer som en del av ditt förtroendeunderlag.
          Dina Tradera-uppgifter används endast för att hämta information kopplad till dina affärer.
        </p>

        <div class="row">
          <div>
            <label for="tradera-username-input">Tradera-användarnamn</label>
            <input id="tradera-username-input" type="text" placeholder="Ditt Tradera-användarnamn" />
          </div>
          <div>
            <label for="tradera-password-input">Tradera-lösenord (valfritt)</label>
            <input id="tradera-password-input" type="password" placeholder="Ditt Tradera-lösenord" />
            <p class="tiny muted">
              Lösenordet lagras krypterat. Lämna tomt om du bara vill spara användarnamnet.
            </p>
          </div>
        </div>

        <div class="row" style="margin-top:8px;">
          <button type="button" class="primary" id="tradera-connect-btn">
            Koppla / uppdatera Tradera-konto
          </button>
          <button type="button" class="secondary" id="tradera-mock-btn">
            Skapa demoaffärer från Tradera
          </button>
          <button type="button" class="secondary" id="tradera-sync-btn">
            Synka riktiga Tradera-affärer
          </button>
        </div>

        <p id="tradera-notice" class="tiny muted" style="margin-top:8px;"></p>

        <hr style="margin:16px 0;border:none;border-top:1px solid rgba(0,0,0,.06);" />

        <h3>Översikt</h3>
        <ul class="profile-list">
          <li>
            <span class="profile-label">Användarnamn</span>
            <span class="profile-value" id="tradera-username-label">–</span>
          </li>
          <li>
            <span class="profile-label">Senast synkad</span>
            <span class="profile-value" id="tradera-last-synced">–</span>
          </li>
        </ul>

        <div id="tradera-orders-section" style="margin-top:12px;">
          <h3>Avslutade affärer från Tradera</h3>
          <p id="tradera-orders-summary" class="tiny muted"></p>
          <div id="tradera-orders-list" class="ratings-list"></div>
        </div>

      </section>

      <!-- Mitt omdöme -->
      <section class="card">
        <h2>Mitt omdöme</h2>
        <p class="tiny muted">
          Sammanfattning av betyg som är kopplade till din e-postadress.
        </p>

        <!-- Två illustrationer högst upp -->
        <div class="ratings-visuals">
          <div class="ratings-visual-box">
            <h3 class="tiny">Varifrån kommer dina omdömen?</h3>
            <div id="rating-source-pie" class="rating-pie">
              <div id="rating-source-pie-label" class="rating-pie-center-label">Inga omdömen</div>
            </div>
            <div id="rating-source-legend" class="rating-legend tiny muted"></div>
          </div>

          <div class="ratings-visual-box">
            <h3 class="tiny">Din PeerRate-rating</h3>
            <div id="rating-p-symbols" class="rating-p-row"></div>
            <div id="rating-p-symbols-text" class="tiny muted"></div>
          </div>
        </div>

        <p class="score-line">
          Snittbetyg:
          <strong><span id="profile-score">–</span> / 5</strong>
          <span class="tiny muted">
            (baserat på <span id="profile-score-count">0</span> omdömen)
          </span>
        </p>
        <div class="score-bar">
          <div class="score-bar-fill" id="profile-score-bar"></div>
        </div>

        <!-- (Valfri) stapelinfo per källa kan vi använda senare -->
        <div id="ratings-graph" class="ratings-graph"></div>

        <!-- Individuella betyg + kommentarer -->
        <div id="ratings-list" class="ratings-list"></div>
      </section>

      <!-- Logga ut -->
      <section class="card">
        <button id="logout-btn" type="button" class="secondary">Logga ut</button>
      </section>

    </div>
  </div>

  <script type="module" src="/modules/main.js"></script>
</body>
</html>
