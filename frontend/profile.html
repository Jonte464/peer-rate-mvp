<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Min profil â€“ PeerRate</title>

  <link rel="stylesheet" href="/css/pr-theme.css" />
  <link rel="stylesheet" href="/css/profile.css" />
</head>

<body>

  <!-- TOP ROW (samma struktur/ID som index fÃ¶r att main.js ska fungera) -->
  <header class="top-row">
    <div class="shell top-row-inner">
      <a class="brand soft-hover" href="/#top">
        <div class="logo-badge" aria-hidden="true">
          <img class="logo-img" src="/assets/Logo.PNG?v=1" alt="PeerRate logo" />
        </div>
        <div>
          <div class="brand-name">PeerRate</div>
          <div class="brand-sub" data-i18n="top_sub">FÃ¶rtroende du kan bevisa</div>
        </div>
      </a>

      <div class="top-actions">
        <div class="top-user" id="topUserPill" aria-live="polite" title="Inloggad" aria-expanded="false">
          <span id="topUserInitials">?</span>
        </div>

        <div class="user-menu" id="userMenu" role="menu" aria-label="AnvÃ¤ndarmeny">
          <button type="button" id="logoutBtn" data-i18n="user_logout">Logga ut</button>
        </div>

        <button class="lang-pill soft-hover" id="langBtn" type="button" aria-haspopup="true" aria-expanded="false">
          <span id="langLabel">SV</span>
          <span style="opacity:.6;">â–¾</span>
        </button>

        <button class="menu-btn soft-hover" id="menuBtn" type="button" aria-label="Ã–ppna meny" aria-expanded="false">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M4 7h16M4 12h16M4 17h16" stroke="rgba(15,15,18,.85)" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </div>

    <div class="lang-menu" id="langMenu" role="menu" aria-label="VÃ¤lj sprÃ¥k">
      <button type="button" data-lang="sv">Svenska (SV)</button>
      <button type="button" data-lang="en">English (EN)</button>
    </div>

    <nav class="menu-panel" id="menuPanel" aria-label="Meny">
      <div class="shell menu-panel-inner">
        <a class="menu-link" href="/#how"><div data-i18n="menu_how">Hur det funkar</div><span>â†’</span></a>
        <a class="menu-link" href="/#sim"><div data-i18n="menu_sim">Se vÃ¤rdet direkt</div><span>â†’</span></a>
        <a class="menu-link" href="/#globe"><div data-i18n="menu_globe">Global trust</div><span>â†’</span></a>

        <a class="menu-link" href="/rate.html"><div data-i18n="menu_rate">LÃ¤mna betyg</div><span>â†’</span></a>

        <!-- âœ… Ny produkt -->
        <a class="menu-link" href="/references.html"><div data-i18n="menu_refs">Arbetsreferenser</div><span>â†’</span></a>

        <a class="menu-link" href="/customer.html"><div data-i18n="menu_signup">Registrera dig</div><span>â†’</span></a>
        <a class="menu-link" href="/profile.html"><div data-i18n="menu_profile">Min profil</div><span>â†’</span></a>
      </div>
    </nav>
  </header>

  <main class="page">
    <div class="wrap">

      <!-- Inloggningsbadge -->
      <div id="user-badge" class="user-badge hidden">
        <div class="user-avatar" id="user-badge-avatar">PR</div>
        <div>
          <div class="user-label" data-i18n="profile_badge_label">Inloggad som</div>
          <div class="user-name" id="user-badge-name">â€“</div>
        </div>
      </div>

      <h1 data-i18n="profile_h1">Min profil</h1>
      <p class="lead" data-i18n="profile_lead">
        HÃ¤r kan du se dina uppgifter och ditt samlade omdÃ¶me.
      </p>

      <!-- LOGIN-KORT (visas bara om man inte Ã¤r inloggad) -->
      <section class="card" id="login-card">
        <h2 data-i18n="profile_login_title">Logga in</h2>
        <p class="muted" data-i18n="profile_login_lead">
          Logga in med den e-post och det lÃ¶senord du registrerade dig med.
        </p>

        <form id="login-form" autocomplete="off">
          <label for="login-email" data-i18n="profile_login_email">E-post</label>
          <input id="login-email" name="email" type="email" placeholder="erik@example.com" />

          <label for="login-password" data-i18n="profile_login_password">LÃ¶senord</label>
          <input id="login-password" name="password" type="password" placeholder="Ditt lÃ¶senord" />

          <div class="row" style="margin-top:12px">
            <button class="primary" type="submit" id="login-btn" data-i18n="profile_login_btn">Logga in</button>
          </div>

          <p id="login-status" class="tiny muted" style="margin-top:8px;"></p>
        </form>
      </section>

      <!-- Allt hÃ¤r visas bara nÃ¤r man Ã¤r inloggad -->
      <div id="profile-root" class="hidden">

        <!-- Trust Profile Card (demo / kan bytas ut senare) -->
        <section class="trust-profile-card" style="background:#fff;border-radius:16px;padding:32px 32px 24px 32px;box-shadow:0 4px 24px rgba(0,0,0,0.07);margin-bottom:32px;position:relative;max-width:900px;margin-left:auto;margin-right:auto;">
          <button id="profile-share-btn" style="position:absolute;top:24px;right:32px;background:#f8fafc;border:1px solid #cbd5e1;color:#1d4ed8;padding:8px 22px 8px 22px;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;white-space:nowrap;box-shadow:0 1px 2px rgba(0,0,0,.03);">Share PeerRate</button>
          <div style="display:flex;align-items:center;gap:28px;">
            <img id="profile-photo" src="https://randomuser.me/api/portraits/women/44.jpg" alt="Profile photo" style="width:96px;height:96px;border-radius:50%;object-fit:cover;border:3px solid #e5e7eb;box-shadow:0 2px 8px rgba(0,0,0,.06);">
            <div style="flex:1;">
              <div id="profile-fullname" style="font-size:2rem;font-weight:700;line-height:1.1;">Anna Larsson</div>
              <div id="profile-title" style="font-size:1.1rem;color:#555;font-weight:500;margin-top:2px;">Senior Project Manager</div>
              <div id="profile-location" style="font-size:1rem;color:#888;margin-top:2px;">Stockholm, Sweden</div>
            </div>
          </div>
          <div style="margin-top:28px;background:#f8fafc;border-radius:12px;padding:24px 24px 18px 24px;border:1px solid #e5e7eb;">
            <div style="font-size:1.2rem;font-weight:600;color:#222;margin-bottom:8px;">PeerRate Score: <span id="profile-score-big" style="font-size:2.2rem;font-weight:800;color:#1d4ed8;">82</span><span style="font-size:1.1rem;font-weight:500;color:#555;"> of 100</span></div>
            <div style="display:flex;gap:10px;margin-bottom:8px;flex-wrap:wrap;">
              <span id="badge-verified" style="background:#2563eb;color:#fff;padding:6px 16px;border-radius:8px;font-size:1rem;font-weight:600;display:flex;align-items:center;gap:6px;"><svg width="18" height="18" fill="none" style="vertical-align:middle;"><circle cx="9" cy="9" r="9" fill="#fff"/><path d="M6 9.5l2 2 4-4" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>Verified Engagements</span>
              <span id="badge-confidence" style="background:#e0e7ff;color:#1d4ed8;padding:6px 16px;border-radius:8px;font-size:1rem;font-weight:600;display:flex;align-items:center;gap:6px;"><svg width="18" height="18" fill="none" style="vertical-align:middle;"><circle cx="9" cy="9" r="9" fill="#fff"/><path d="M6 9.5l2 2 4-4" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>High Confidence</span>
              <span id="badge-strong" style="background:#e0e7ff;color:#1d4ed8;padding:6px 16px;border-radius:8px;font-size:1rem;font-weight:600;display:flex;align-items:center;gap:6px;"><svg width="18" height="18" fill="none" style="vertical-align:middle;"><circle cx="9" cy="9" r="9" fill="#fff"/><path d="M6 9.5l2 2 4-4" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>Strong Verification</span>
            </div>
            <div style="display:flex;gap:32px;margin-top:18px;flex-wrap:wrap;">
              <div style="flex:1;min-width:180px;display:flex;align-items:center;gap:10px;">
                <span style="color:#22c55e;font-size:1.5rem;">âœ”ï¸</span>
                <div><span style="font-weight:700;">Client Feedback:</span><br><span id="feedback-client" style="color:#222;">Excellent</span></div>
              </div>
              <div style="flex:1;min-width:180px;display:flex;align-items:center;gap:10px;">
                <span style="color:#22c55e;font-size:1.5rem;">âœ”ï¸</span>
                <div><span style="font-weight:700;">Leadership & Collaboration:</span><br><span id="feedback-leadership" style="color:#222;">Strong</span></div>
              </div>
              <div style="flex:1;min-width:180px;display:flex;align-items:center;gap:10px;">
                <span style="color:#22c55e;font-size:1.5rem;">âœ”ï¸</span>
                <div><span style="font-weight:700;">Consistency:</span><br><span id="feedback-consistency" style="color:#222;">Recent & Stable</span></div>
              </div>
            </div>
            <div style="margin-top:18px;display:flex;align-items:center;gap:10px;">
              <span style="color:#2563eb;font-size:1.5rem;">âœ”ï¸</span>
              <div><span style="font-weight:700;">Verification Level:</span> <span id="verification-level" style="color:#222;">High</span></div>
            </div>
          </div>
          <div style="margin-top:32px;">
            <div style="font-size:1.1rem;font-weight:700;margin-bottom:10px;">Recent Engagement</div>
            <div style="background:#f8fafc;border:1px solid #e5e7eb;border-radius:12px;padding:18px 20px 14px 20px;display:flex;align-items:flex-start;gap:18px;">
              <div style="font-size:2rem;color:#2563eb;margin-right:8px;">ğŸ¦</div>
              <div style="flex:1;">
                <div style="font-size:1.1rem;font-weight:700;display:inline;" id="engagement-title">Large Bank</div> <span style="color:#888;" id="engagement-industry">| Finance</span>
                <div style="margin-top:2px;"><span style="font-weight:600;">Role:</span> <span style="font-weight:700;" id="engagement-role">Senior Project Manager</span></div>
                <div style="margin-top:2px;"><span style="font-weight:600;">Skills:</span> <span style="color:#222;" id="engagement-skills">Project Management, Risk & Compliance, <b>Data Analytics</b></span></div>
                <div style="margin-top:6px;color:#444;" id="engagement-desc">Led implementation of new compliance system for a major bank. Managed a team of 8 consultants.</div>
              </div>
            </div>
          </div>
          <div style="margin-top:28px;display:flex;gap:18px;flex-wrap:wrap;">
            <div style="background:#f1f5f9;border-radius:10px;padding:18px 18px 14px 18px;flex:1;min-width:220px;max-width:320px;box-shadow:0 1px 4px rgba(0,0,0,.03);border:1px solid #e5e7eb;">
              <div style="color:#2563eb;font-weight:700;margin-bottom:6px;">Client Reference</div>
              <div id="testimonial-client" style="font-size:1.1rem;font-style:italic;color:#222;">â€œAnna delivered excellent results on time.â€</div>
              <div style="margin-top:10px;color:#555;font-size:0.98rem;">â€” <span id="testimonial-client-author">Magnus S.</span>, <span style="font-style:italic;" id="testimonial-client-role">Risk Director</span></div>
            </div>
            <div style="background:#f1f5f9;border-radius:10px;padding:18px 18px 14px 18px;flex:1;min-width:220px;max-width:320px;box-shadow:0 1px 4px rgba(0,0,0,.03);border:1px solid #e5e7eb;">
              <div style="color:#22c55e;font-weight:700;margin-bottom:6px;">Manager Endorsement</div>
              <div id="testimonial-manager" style="font-size:1.1rem;font-style:italic;color:#222;">â€œGreat leader with strong strategic focus.â€</div>
              <div style="margin-top:10px;color:#555;font-size:0.98rem;">â€” <span id="testimonial-manager-author">Elin L.</span>, <span style="font-style:italic;" id="testimonial-manager-role">Consulting Director</span></div>
            </div>
            <div style="background:#f1f5f9;border-radius:10px;padding:18px 18px 14px 18px;flex:1;min-width:220px;max-width:320px;box-shadow:0 1px 4px rgba(0,0,0,.03);border:1px solid #e5e7eb;">
              <div style="color:#2563eb;font-weight:700;margin-bottom:6px;">Team Feedback</div>
              <div id="testimonial-team" style="font-size:1.1rem;font-style:italic;color:#222;">â€œAnna is a fantastic team lead!â€</div>
              <div style="margin-top:10px;color:#555;font-size:0.98rem;">â€” <span id="testimonial-team-author">Erik J.</span>, <span style="font-style:italic;" id="testimonial-team-role">Data Analyst</span></div>
            </div>
          </div>
        </section>

        <script>
          // Share button logic
          const shareBtn = document.getElementById('profile-share-btn');
          if (shareBtn) {
            shareBtn.addEventListener('click', function() {
              navigator.clipboard.writeText(window.location.href);
              shareBtn.textContent = 'Copied!';
              setTimeout(()=>shareBtn.textContent='Share PeerRate',1200);
            });
          }
        </script>

        <!-- âœ… Mitt omdÃ¶me (flyttad hÃ¶gst upp) -->
        <section class="card">
          <h2 data-i18n="profile_my_rating_title">Mitt omdÃ¶me</h2>
          <p class="tiny muted" data-i18n="profile_my_rating_lead">
            Sammanfattning av betyg som Ã¤r kopplade till din e-postadress.
          </p>

          <div class="ratings-visuals">
            <div class="ratings-visual-box">
              <h3 class="tiny" data-i18n="profile_rating_sources_title">VarifrÃ¥n kommer dina omdÃ¶men?</h3>
              <div id="rating-source-pie" class="rating-pie">
                <div id="rating-source-pie-label" class="rating-pie-center-label" data-i18n="profile_no_ratings">Inga omdÃ¶men</div>
              </div>
              <div id="rating-source-legend" class="rating-legend tiny muted"></div>
            </div>

            <div class="ratings-visual-box">
              <h3 class="tiny" data-i18n="profile_pr_rating_title">Din PeerRate-rating</h3>
              <div id="rating-p-symbols" class="rating-p-row"></div>
              <div id="rating-p-symbols-text" class="tiny muted"></div>
            </div>
          </div>

          <p class="score-line">
            <span data-i18n="profile_avg_label">Snittbetyg:</span>
            <strong><span id="profile-score">â€“</span> / 5</strong>
            <span class="tiny muted">(<span data-i18n="profile_based_on">baserat pÃ¥</span> <span id="profile-score-count">0</span> <span data-i18n="profile_reviews">omdÃ¶men</span>)</span>
          </p>

          <div class="score-bar">
            <div class="score-bar-fill" id="profile-score-bar"></div>
          </div>

          <div id="ratings-graph" class="ratings-graph"></div>
          <div id="ratings-list" class="ratings-list"></div>
        </section>

        <!-- âœ… Arbetsreferenser / Work References (synkad card-design) -->
        <section class="card" id="work-references-card">
          <h2 data-i18n="work_refs_title">Arbetsreferenser</h2>
          <p class="tiny muted" data-i18n="work_refs_lead">
            Samla och visa verifierade arbetsreferenser frÃ¥n chefer, kollegor och uppdragsgivare.
          </p>

          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px;">
            <a href="/references.html" class="secondary" style="text-decoration:none;display:inline-block;padding:10px 14px;border-radius:10px;">
              <span data-i18n="work_refs_open">Ã–ppna arbetsreferenser</span> â†’
            </a>
            <a href="/references.html" class="secondary" style="text-decoration:none;display:inline-block;padding:10px 14px;border-radius:10px;">
              <span data-i18n="work_refs_invite">Bjud in en referens</span> â†’
            </a>
          </div>

          <div style="margin-top:12px;border:1px solid rgba(0,0,0,.08);background:#fff;border-radius:12px;padding:12px;">
            <div style="font-weight:800;" data-i18n="work_refs_status_title">Status</div>
            <div style="margin-top:6px;color:rgba(15,15,18,.65);font-size:13px;line-height:1.5;" data-i18n="work_refs_status_body">
              (Demo) HÃ¤r kommer dina referenser att listas. NÃ¤sta steg Ã¤r att koppla detta till LinkedIn-inloggning och ett enkelt â€œbe om referensâ€-flÃ¶de.
            </div>
          </div>
        </section>

        <!-- Mina uppgifter -->
        <section class="card">
          <h2 data-i18n="profile_my_details_title">Mina uppgifter</h2>
          <p class="tiny muted" data-i18n="profile_my_details_lead">Uppgifter kopplade till din profil.</p>

          <!-- Profilbild -->
          <div class="profile-avatar-block">
            <div class="profile-avatar-preview" id="profile-avatar-preview">PR</div>
            <div>
              <label class="profile-avatar-upload-label" data-i18n="profile_avatar_upload">
                Ladda upp profilbild
                <input type="file" id="profile-avatar-input" accept="image/*" />
              </label>
              <p class="profile-avatar-text" data-i18n="profile_avatar_note">
                Bilden sparas bara lokalt i din webblÃ¤sare och kopplas till â€œInloggad somâ€.
              </p>
            </div>
          </div>

          <ul class="profile-list">
            <li><span class="profile-label">Namn</span><span class="profile-value" id="profile-name">â€“</span></li>
            <li><span class="profile-label">E-post</span><span class="profile-value" id="profile-email">â€“</span></li>
            <li><span class="profile-label">Personnummer</span><span class="profile-value" id="profile-personalNumber">â€“</span></li>
            <li><span class="profile-label">Telefon</span><span class="profile-value" id="profile-phone">â€“</span></li>
            <li><span class="profile-label">Gatuadress</span><span class="profile-value" id="profile-addressStreet">â€“</span></li>
            <li><span class="profile-label">Postnummer</span><span class="profile-value" id="profile-addressZip">â€“</span></li>
            <li><span class="profile-label">Ort</span><span class="profile-value" id="profile-addressCity">â€“</span></li>
            <li><span class="profile-label">Land</span><span class="profile-value" id="profile-country">â€“</span></li>
          </ul>
        </section>

        <!-- Externa data -->
        <section class="card" id="external-data-section">
          <h2>Externa data</h2>
          <p class="tiny muted">
            HÃ¤r visas viss information som hÃ¤mtats frÃ¥n externa, offentliga kÃ¤llor kopplat till din profil.
            Uppgifterna uppdateras automatiskt med jÃ¤mna mellanrum.
          </p>

          <ul class="profile-list">
            <li><span class="profile-label">Fordon (antal)</span><span class="profile-value" id="ext-vehicles-count"></span></li>
            <li><span class="profile-label">Fastigheter (antal)</span><span class="profile-value" id="ext-properties-count"></span></li>
            <li><span class="profile-label">Senast uppdaterad</span><span class="profile-value" id="ext-last-updated"></span></li>
            <li><span class="profile-label">Validerad adress</span><span class="profile-value"><span data-field="externalAddressLine">â€“</span></span></li>
            <li><span class="profile-label">Adressstatus</span><span class="profile-value"><span data-field="externalAddressStatus">â€“</span></span></li>
          </ul>
        </section>

        <!-- eBay-koppling (tillfÃ¤lligt dold) -->
        <section class="card hidden" id="ebay-card" style="display:none;">
          <!-- eBay Ã¤r tillfÃ¤lligt avstÃ¤ngt i UI -->
        </section>

        <!-- Tradera-koppling (tillfÃ¤lligt dold) -->
        <section class="card hidden" id="tradera-card" style="display:none;">
          <!-- Tradera Ã¤r tillfÃ¤lligt avstÃ¤ngt i UI -->
        </section>

        <!-- Logga ut -->
        <section class="card">
          <button id="logout-btn" type="button" class="secondary" data-i18n="profile_logout_btn">Logga ut</button>
        </section>

      </div>

      <div style="text-align:center;color:rgba(15,15,18,.55);font-size:12px;margin-top:18px;">
        Â© 2025 by PeerRate.
      </div>
    </div>
  </main>

  <!-- âœ… Viktigt: initiera sprÃ¥k Ã¤ven pÃ¥ profilsidan -->
  <script type="module">
    import { initLandingLanguage } from '/modules/landing/language.js';
    initLandingLanguage();
  </script>

  <script type="module" src="/modules/main.js"></script>
</body>
</html>
