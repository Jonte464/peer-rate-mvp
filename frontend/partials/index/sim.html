<!-- SIM -->
<section id="sim" class="section anchor">
  <div class="shell">
    <h2 class="section-title" data-i18n="sim_title">Se värdet direkt.</h2>

    <!-- example profile card removed -->

    <div class="sim-row">

      <!-- Simulator – 5P + två sliders -->
      <div class="sim">
        <div>
          <h3 data-i18n="sim_h3">Vad händer när fler lämnar omdömen – och de är bra?</h3>
          <p data-i18n="sim_p">
            Två reglage styr den totala nivån. Få omdömen + lågt snitt ger låg nivå. Många omdömen + högt snitt ger 5P.
          </p>

          <div class="slider-stack">
            <div>
              <div style="display:flex; justify-content:space-between; gap:10px; margin-bottom:6px;">
                <b data-i18n="sim_count_label">Antal omdömen</b>
                <span style="color:rgba(11,22,51,.62); font-weight:800;"><span id="simCount">10</span> st</span>
              </div>
              <div class="slider-row">
                <input id="countSlider" type="range" min="0" max="200" value="10" />
              </div>
            </div>

            <div>
              <div style="display:flex; justify-content:space-between; gap:10px; margin-bottom:6px;">
                <b data-i18n="sim_avg_label">Genomsnittligt omdöme</b>
                <span style="color:rgba(11,22,51,.62); font-weight:800;"><span id="simAvg">4.6</span> / 5</span>
              </div>
              <div class="slider-row">
                <input id="avgSlider" type="range" min="1" max="5" step="0.1" value="4.6" />
              </div>
            </div>
          </div>
        </div>

        <div>
          <div class="trust-pill" aria-live="polite">
            <div class="trust-left">
              <div class="trust-title" data-i18n="sim_total_title">Total nivå</div>
              <div class="trust-sub" data-i18n="sim_total_sub">Kombination av volym + kvalitet</div>
            </div>

            <div class="pbar" aria-label="5P rating">
              <div class="p is-on">P</div>
              <div class="p is-on">P</div>
              <div class="p is-on">P</div>
              <div class="p is-on">P</div>
              <div class="p">P</div>
            </div>
          </div>

          <div class="sim-meta" style="margin-top:12px;">
            <div class="meta-box">
              <b id="simScore">4.6</b>
              <span data-i18n="sim_score_label">Förtroende (1–5)</span>
            </div>
            <div class="meta-box">
              <b id="simPCount">4</b>
              <span data-i18n="sim_pcount_label">Fyllda P</span>
            </div>
          </div>

          <div style="margin-top:12px; color:rgba(11,22,51,.62); font-size:12px; font-weight:650;" data-i18n="sim_tip">
            Tips: Prova låg volym + högt snitt (få men bra) vs hög volym + medel (många men ojämnt).
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

<script>
  // Example Test User data (copy of dev test user with made-up metrics)
  (function(){
    const exampleTestUser = {
      id: 'test-dev-user',
      email: 'test@development.local',
      fullName: 'Test User',
      title: 'Independent Consultant',
      location: 'Remote',
      score: 74,
      tags: ['Verified','Portable','Recent'],
      engagement: {
        client: 'Design Agency',
        type: 'UX / Product',
        role: 'Consultant',
        delivered: 'Concept, Roadmap'
      }
    };

    // Populate example card if present
    try {
      const nameEl = document.getElementById('exampleName');
      if (!nameEl) return;

      document.getElementById('exampleName').textContent = exampleTestUser.fullName || '';
      document.getElementById('exampleTitle').textContent = exampleTestUser.title || '';
      document.getElementById('exampleLocation').textContent = exampleTestUser.location || '';
      document.getElementById('exampleScore').textContent = exampleTestUser.score || '';

      const tagsEl = document.getElementById('exampleTags');
      if (tagsEl && exampleTestUser.tags && exampleTestUser.tags.length) {
        tagsEl.innerHTML = '';
        exampleTestUser.tags.forEach(t => {
          const s = document.createElement('span');
          s.className = 'example-tag';
          s.style.cssText = 'background:#06b6d4;color:white;padding:3px 7px;border-radius:4px;font-size:9px;font-weight:600;';
          s.textContent = t;
          tagsEl.appendChild(s);
        });
      }

      const eng = exampleTestUser.engagement || {};
      document.getElementById('exampleEngClient').textContent = eng.client || '';
      document.getElementById('exampleEngType').textContent = eng.type || '';
      document.getElementById('exampleEngDetails').innerHTML = `<div><strong>Role:</strong> ${eng.role||''}</div><div><strong>Delivered:</strong> ${eng.delivered||''}</div>`;
    } catch (err) {
      console.error('Could not populate exampleTestUser card', err);
    }
  })();
</script>
